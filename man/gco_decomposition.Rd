% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gco_decomposition.R
\name{gco_decomposition}
\alias{gco_decomposition}
\title{G-C-O Structural Decomposition}
\usage{
gco_decomposition(
  pcoa_mat,
  projection_scores,
  k = 10,
  tau_H = 0.8,
  tau_L = 0.2
)
}
\arguments{
\item{pcoa_mat}{Numeric \eqn{n \times d} matrix of PCoA coordinates.}

\item{projection_scores}{Numeric vector (length \eqn{n}) of 1-D projection scores.}

\item{k}{Integer, neighbourhood size (default \code{10}).}

\item{tau_H}{High threshold for gradient consistency (default \code{0.8}).}

\item{tau_L}{Low  threshold for cluster consistency (default \code{0.2}).}
}
\value{
A data frame with one row per sample:
\describe{
  \item{\code{consistency_score}}{\eqn{s_i}.}
  \item{\code{outlier}}{Logical flag.}
  \item{\code{class}}{Factor with levels “G-type”, “C-type”, “O-type”, “Intermediate”.}
}
}
\description{
Classifies each sample as \strong{G-type} (gradient-driven),
\strong{C-type} (cluster-driven), or \strong{O-type} (outlier) by comparing
neighbourhood structure in the original PCoA space to that in the 1-D
trait-aligned projection.
}
\details{
\enumerate{
  \item For every sample the \code{k} nearest neighbours are found in
        PCoA (\eqn{\mathcal N_E}) and in projection space
        (\eqn{\mathcal N_G}).
  \item The local \emph{consistency score}
        \eqn{s_i = |\mathcal N_E \cap \mathcal N_G|/k} is computed.
  \item A sample is labelled:
    \describe{
      \item{G-type}{if \eqn{s_i > \tau_H} and not an outlier;}
      \item{C-type}{if \eqn{s_i < \tau_L} and not an outlier;}
      \item{O-type}{if the mean distance to its \code{k} neighbours exceeds
        the 95th percentile in \emph{either} space.}
    }
}
}
\examples{
\dontrun{
  set.seed(1)
  coords <- matrix(rnorm(40 * 2), ncol = 2)
  proj   <- coords \%*\% c(1, 0.5) + rnorm(40)
  gco    <- gco_decomposition(coords, proj, k = 8)
  table(gco$class)
}

}
