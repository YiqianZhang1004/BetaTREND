% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/evaluate_consistency_metrics.R
\name{evaluate_consistency_metrics}
\alias{evaluate_consistency_metrics}
\title{Evaluate Projection–PCoA Consistency}
\usage{
evaluate_consistency_metrics(
  pcoa_mat,
  projection_scores,
  k = 10,
  method = "pearson"
)
}
\arguments{
\item{pcoa_mat}{\eqn{n \times d} numeric matrix of PCoA (or any ordination)
coordinates.}

\item{projection_scores}{Numeric vector of length \eqn{n} containing the
1-D trait-aligned projection scores (e.g.\ output of
\code{\link{gradient_projection}}).}

\item{k}{Integer. The neighbourhood size used for trustworthiness and
continuity (default \code{10}).}

\item{method}{Character string passed to \code{vegan::\link[vegan]{mantel}}
(“pearson” [default] or “spearman”).}
}
\value{
A list with
\describe{
  \item{\code{trustworthiness}}{Value in [0,1]; 1 = perfect.}
  \item{\code{continuity}}{Value in [0,1]; 1 = perfect.}
  \item{\code{mantel_statistic}}{Mantel \eqn{r}.}
  \item{\code{mantel_p}}{Two-sided Mantel p-value.}
}
}
\description{
Computes three standard neighbourhood‐preservation diagnostics that quantify
how faithfully a 1-D trait-aligned projection reproduces structure in a
higher-dimensional PCoA space:
}
\details{
\itemize{
  \item \strong{Trustworthiness} — proportion of projection-space neighbours
        that are also close in the original PCoA space.
  \item \strong{Continuity} — proportion of PCoA-space neighbours that remain
        neighbours in the projection.
  \item \strong{Mantel correlation} — Pearson/Spearman correlation between
        the two distance matrices.
}

Neighbour ranks are shifted by \eqn{-1} so the self-distance has rank 0 and
the nearest neighbour has rank 1 (matching the definition in van der Maaten &
Hinton 2008).
}
\examples{
\dontrun{
  set.seed(1)
  coords <- matrix(rnorm(30 * 3), ncol = 3)
  proj   <- coords \%*\% c(1, 0.5, -0.2) + rnorm(30, 0, 0.1)

  metrics <- evaluate_consistency_metrics(coords, proj, k = 5)
  metrics$trustworthiness
  metrics$continuity
  metrics$mantel_statistic
}

}
\references{
van der Maaten, L.J.P. & Hinton, G.E. (2008) Visualizing Data using
t-SNE. \emph{Journal of Machine Learning Research}, \strong{9}, 2579–2605.
}
