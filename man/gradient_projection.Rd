% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gradient_projection.R
\name{gradient_projection}
\alias{gradient_projection}
\title{Trait-Aligned Gradient Projection in PCoA Space}
\usage{
gradient_projection(distance_matrix, trait, ndim = 5, figure = TRUE)
}
\arguments{
\item{distance_matrix}{Either a numeric \code{dist} object or an
\eqn{n \times n} symmetric distance matrix of community dissimilarities.}

\item{trait}{Numeric vector of length \eqn{n} giving the continuous
phenotype/trait.}

\item{ndim}{Integer. Number of PCoA axes to retain (default \code{5}).}

\item{figure}{Logical. If \code{TRUE} (default) a ggplot2/viridis figure is
printed and returned.}
}
\value{
A list with elements:
\describe{
  \item{projection_scores}{Numeric vector of length \eqn{n}; the trait-aligned
        scores \eqn{\hat y_i = E_i^\top \hat v}.}
  \item{gradient_direction}{Numeric vector of length \code{ndim}; the
        direction \eqn{\hat v}.}
  \item{PCoA_coordinates}{\eqn{n \times ndim} matrix of PCoA scores.}
  \item{adjusted_R2}{Adjusted \eqn{R^{2}} from the regression
        \code{trait ~ E}.}
  \item{p_value}{Global F-test p-value testing traitâ€“embedding association.}
  \item{plot}{\code{ggplot} object (or \code{NULL} if \code{figure = FALSE}).}
  \item{variance_explained}{Vector of eigenvalue proportions.}
}
}
\description{
Compute the 1-D projection of a continuous trait onto a host-community
PCoA embedding (beta-diversity space), following the formulation
\eqn{\hat v = (E^\top E)^{-1} E^\top y}.  The function returns
sample-level projection scores, the gradient direction vector,
adjusted \eqn{R^{2}}, and (optionally) a publication-quality plot.
}
\examples{
\dontrun{
  library(vegan)
  set.seed(1)
  otu   <- matrix(abs(rnorm(100 * 30)), nrow = 100)
  trait <- rnorm(100)
  dist_mat <- vegdist(otu, method = "bray")

  res <- gradient_projection(dist_mat, trait)
  res$plot            # interactive figure
  res$adjusted_R2
}

}
